
<!-- Hello World in 6502 Assembly for the VIC-20 -->

<title>CBM .PRG FILES on the VIC-20</title>

<body>
	<h1>Commodore .PRG files on the VIC-20</h1>
	<h2>COMING SOMEDAY</h2>
	<p>
		A breakdown and guide to the Commodore .PRG file format, and creating and running prg files on the VIC-20.
	</p>
	<p>
		Commodore's <code>.prg</code> filetype is a simple executable file format used in the PET,
		VIC-20, C64, and C128. It is a simple (BASIC?) format, but the details of how a <code>.prg</code>
		file is implemented on a particular Commodore system as well as what the file format can and
		cannot do require some elaboration.
	</p>
	<br></br>
	<h2>Anatomy of a PRG File</h2>
	<p>
		<b>HEADER + PROGRAM</b><br>
		The gross anatomy of a Commodore <code>.prg</code> file is a two-byte header followed by 
		the sequence of bytes that comprise the body of the program. The two-byte header designates
		the memory location into which the program is to be loaded. This location is almost always
		designated to be the start of the user's BASIC program RAM space. For the VIC-20 that address 
		is 0x1001 and for the C64 0x8001 (while these systems' user RAM starts at 0x1000 and 0x8000,
		respectively, for some reason these first bytes create issues, hence starting one byte into the
		user RAM space). When loading the program into main memory, the system skips the header and only 
		loads the program byte sequence into memory starting at the designated memory location.
	</p>
	<p>
		Once loaded, the <code>.prg</code> program can be run by typing <code>RUN</code> into the 
		system BASIC interpreter. The program itself can either be a BASIC program or a 6502 assembly 
		program, or a mix (and in fact, an assembly program requires a small BASIC launch program)
	</p>
	<br></br>
	<h2>Anatomy of an Assembly Program</h2>
	<p>A breakdown of the hello-world.prg program produce by the simple
	   <a href="https://etvanlieshout.github.io/vic-20/vic-20-hello-world.html">Hello World program</a>
	   on this site.
	</p>
	<p><b>HEX DUMP</b><br>Hex dump of our simple hello-world.prg<br>
	<pre>
		<code>
00000000: 0110 0d10 0a00 9e28 3431 3131 2900 0000  .......(4111)...
00000010: 4c20 1048 454c 4c4f 2057 4f52 4c44 110d  L .HELLO WORLD..
00000020: 00a2 008a 48bd 1210 f009 20d2 ff68 aae8  ....H..... ..h..
00000030: 4c22 10ea                                L"..           
		</code>
	</pre>
	</p>
	<p>
		<b>Header</b>: The first two bytes <code>01 10</code>are the header, designating the memory address into which
		the program will be loaded. Little-Endian format. 
	</p>
	<p>
		<b>BASIC Launch Program</b>: The next 14 bytes comprise a short BASIC program (tokenized) that launches and executes
		the machine language program.<br> <!--insert bytes here-->
		<code>BASIC:  10 SYS 4111</code>
                <code>BYTES:  0d10 0a00 9e28 3431 3131 2900 0000 </code>
	</p>
	<!--INSERT table breaking down the BASIC program-->
	<p>
	<b>Machine Language Program</b>: The machine language program is broken into two parts: data and instructions.
	This is a personal design choice
	</p>
</body>
